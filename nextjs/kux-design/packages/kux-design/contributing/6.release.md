# 网站更新&库的发布

## 组件库文档网站更新步骤
文档网站使用另外的仓库 [kufox-website](https://bitbucket.kucoin.net/projects/KUFD/repos/kufox-website/browse)(没有权限需申请) 来发布, 文档发布在内网, 只能通过内网访问

### 更新前准备

1. 在本地克隆 kufox-website 仓库
2. 确保本目录下的 `.env.local`(可复制.env.example) 中的 `KUFOX_WEBSITE_REPO_PATH` 指向了本地 kufox-website仓库路径
3. 将其分支切换到 `feature/update-doc`

### 发布步骤
1. 在本仓库中执行命令 `./scripts/update-docs-site.sh`
2. 结束后在打开的浏览器页面中确认创建PR, 再 CR
3. 打开 <https://kufox.kcprd.com/ci_cd/sprint/6098#1> 将 kufox-website 提测, 提测后大概率会发现卡点检查中安全检查不通过(因为文档为构建出来的产物, 有很多不和安全要求的代码, 但因为文档只在内网访问, 并无问题), 需要 「应用安全研发同步群」中将安全扫描不通过的链接发出, 找安全同学 bypass 即可. bypass 后再次提测即可
4. 找测试同学将 kufox-website 部署到 `sit 01`(一定要是 sit 01, 文档站部署有作特殊处理)


以上的脚本 `./scripts/update-docs-site.sh`, 做了如下事情:

1. 在本目录中执行命令 `pnpm build-docs` 构建文档, 生成的 `docs-build` 即为构建好的文档
2. 清理 kufox-website 仓库中的 `public/next` 文件夹
3. 将刚构建好的 `docs-build` 文件夹复制到 kufox-website 的 `public` 文件夹中, 将 `docs-build` 重命名为 `next`, 并提交代码
4. 在 kufox-website 中提交代码
5. 打开 PR 链接

操作完, 访问 <https://kux.sit.kucoin.net/next/> 即可查看最新文档